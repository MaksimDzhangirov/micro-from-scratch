# Требования к микросервису

28 августа 2014

![Martin Fowler](images/microservices/mf.jpg)

[Мартин Фаулер](https://martinfowler.com/)

[МИКРОСЕРВИСЫ](https://martinfowler.com/tags/microservices.html)

Когда я говорю с людьми об использовании [архитектурного стиля микросервисов](https://martinfowler.com/articles/microservices.html), я 
слышу много оптимизма. Разработчикам нравится работать с небольшими модулями, и 
они рассчитывают на лучшую модульность, чем в случае монолитов. Но, как и в 
любом архитектурном решении, здесь есть компромиссы. В частности, микросервисы 
имеют серьезные последствия для операций, которым теперь приходится работать с 
экосистемой небольших сервисов, а не с одним четко определенным монолитом. 
Следовательно, если у вас нет определенных базовых компетенций, вам не следует 
использовать стиль микросервисов.

![sketch](images/MicroservicePrerequisites/sketch.png)

**Быстрое предоставление**: вы сможете запустить новый сервер в течение 
нескольких часов. Естественно, это соответствует [облачным вычислениям](https://martinfowler.com/bliki/CloudComputing.html), но это 
также то, что можно сделать без полноценного облачного сервиса. Чтобы иметь 
возможность выполнять такую быструю подготовку, вам потребуется много 
автоматизации — возможно, она не должна быть полностью автоматизирована для 
начала, но позже для создания серьезных микросервисов она должна быть такой.

**Базовый мониторинг**: когда в производственной среде взаимодействует множество 
слабо связанных служб, неизбежно возникают проблемы, которые трудно обнаружить 
в тестовых средах. В результате важно, чтобы был установлен режим мониторинга 
для быстрого обнаружения серьезных проблем. Базовым уровнем здесь является 
обнаружение технических проблем (ошибки подсчета, доступность услуг и т. д.), 
но также стоит отслеживать бизнес-проблемы (например, обнаружение потери 
заказов). Если возникает внезапная проблема, вам нужно убедиться, что вы можете 
быстро откатиться, поэтому...

**Быстрое развертывание приложений**: при наличии множества сервисов, которыми 
нужно управлять, вам необходимо иметь возможность быстро развертывать их как в 
тестовых средах, так и в продакшен среде. Обычно это касается [DeploymentPipeline](https://martinfowler.com/bliki/DeploymentPipeline.html), 
который может выполняться не более чем за пару часов. Некоторое ручное вмешательство 
допустимо на ранних этапах, но вскоре вы захотите полностью автоматизировать 
его.

Эти возможности подразумевают важный организационный сдвиг — тесное 
сотрудничество между разработчиками и операторами: [**DevOpsCulture**](https://martinfowler.com/bliki/DevOpsCulture.html). Это 
сотрудничество необходимо для обеспечения быстрой подготовки и развертывания. 
Также важно гарантировать, что вы сможете быстро реагировать, когда ваш 
мониторинг указывает на проблему. В частности, любое управление инцидентами 
должно привлекать команду разработчиков и операции как к устранению 
непосредственной проблемы, так и к анализу первопричины, чтобы убедиться, что 
основные проблемы устранены.

С такой настройкой вы готовы к первой системе, использующей несколько 
микросервисов. Разверните эту систему и используйте ее в продакшен среде, ожидая 
узнать много нового о том, как поддерживать ее работоспособность и обеспечивать, 
чтобы совместная работа с девопсами работала хорошо. Дайте себе время, чтобы 
сделать это, извлечь уроки из этого и развить больше возможностей, прежде чем 
увеличивать количество своих сервисов.

Если у вас нет этих возможностей сейчас, вы должны разработать их, чтобы они 
были готовы к тому времени, когда вы запустите микросервисную систему в 
продакшен. На самом деле, это те возможности, которые вы действительно должны 
иметь и для монолитных систем. Хотя они не всегда присутствуют в организациях, 
занимающихся разработкой программного обеспечения, очень мало мест, где они не 
должны иметь высокий приоритет.

Чтобы выйти за рамки нескольких услуг, требуется больше усилий. Вам нужно 
будет отслеживать бизнес-транзакции с помощью нескольких сервисов и 
автоматизировать подготовку и развертывание, полностью используя 
[ContinuousDelivery](https://martinfowler.com/bliki/ContinuousDelivery.html). Также необходимо начать переход к [командам, ориентированным 
на продукт](https://martinfowler.com/articles/microservices.html#OrganizedAroundBusinessCapabilities). Вам нужно организовать среду разработки, чтобы разработчики могли 
легко переключаться между несколькими репозиториями, библиотеками и языками. 
Некоторые из моих контактов чувствуют, что здесь может быть полезная модель 
[MaturityModel](https://martinfowler.com/bliki/MaturityModel.html), которая может помочь организациям по мере того, как они внедряют 
больше микросервисов — мы должны увидеть больше разговоров об этом в ближайшие 
несколько лет.

## Благодарности

Этот список был составлен в ходе обсуждений с моими коллегами из Thoughtworks, 
особенно с теми, кто присутствовал на саммите по микросервисам в начале этого 
года. Затем я структурировал и завершил список в ходе обсуждения с **Эваном 
Ботчером**, **Тиягу Паланисами**, **Сэмом Ньюманом** и **Джеймсом Льюисом**.

И, как обычно, были ценные комментарии из нашего внутреннего списка рассылки почты
от Криса Форда, Кифа Морриса, Премананда Чандрасекарана, Ребекки Парсонс, 
Сары Тарапорвалла и Яна Картрайта.