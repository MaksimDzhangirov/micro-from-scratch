# Проверка с учётом контекста

7 декабря 2005

![Martin Fowler](../microservice-guide/images/microservices/mf.jpg)

[Мартин Фаулер](https://martinfowler.com/)

[ПРЕДМЕТНО-ОРИЕНТИРОВАННОЕ ПРОЕКТИРОВАНИЕ](https://martinfowler.com/tags/domain%20driven%20design.html)
[АРХИТЕКТУРА ПРИЛОЖЕНИЯ](https://martinfowler.com/tags/application%20architecture.html)

Я давно хотел написать статью о валидации. Это область, которая приводит к 
большой путанице, и было бы хорошо получить подробное описание некоторых хорошо 
работающих методов. Однако жизнь полна вещей, о которых можно написать, даже 
больше, чем позволяет время.

Некоторые недавние прочитанные мною работы заставили меня задуматься о том, 
чтобы сказать несколько предварительных вещей по теме. Я часто вижу как люди
разрабатывают процедуры для проверки объектов. Эти процедуры создаются по-разному, 
они могут входить в объект или быть внешними, они могут возвращать логическое 
значение или выдавать исключение, указывающее на сбой. Но одна вещь, которая, 
как мне кажется, постоянно сбивает людей с толку, — это когда они думают, что 
валидность объекта не зависит от контекста, как предполагает метод `isValid`.

Я думаю, гораздо полезнее думать о проверке как о чем-то, что связано с контекстом — 
обычно действием, которое вы хотите выполнить. Можно ли обработать этот заказ,
можно ли зарегистрировать этого клиента в отеле? Таким образом, вместо таких 
методов, как `isValid`, используйте такие методы, как `isValidForCheckIn`.

Одним из следствий этого является то, что сохранение объекта в базе данных само 
по себе является действием. Размышляя об этом таким образом, возникает ряд важных 
вопросов. Часто, когда люди говорят о неконтекстной валидности, они имеют в виду 
сохранение в базе данных. Но здесь при проверке правил необходимо задаваться 
вопросом «должно ли невыполнение этого условия помешать сохранению?»

В книге [Об интерфейсе](https://www.amazon.com/gp/product/1568843224/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1568843224&linkCode=as2&tag=martinfowlerc-20)
Алан Купер утверждал, что мы не должны позволять нашим представлениям о 
правильных состояниях мешать пользователю вводить (и сохранять) неполную 
информацию. Я вспомнил об этом несколько дней назад, когда читал черновик книги, 
над которой работает [Джимми Нильссон](http://www.jnsk.se/weblog/rss.xml).
Он сформулировал принцип, согласно которому вы всегда должны иметь возможность 
сохранить объект, даже если в нем есть ошибки. Хотя я не уверен, что это должно 
быть абсолютным правилом, я все же думаю, что люди склонны избегать сохранений 
больше, чем следует. Учёт контекста при проверке может помочь предотвратить это.

Опубликовано 03 ноября 2011