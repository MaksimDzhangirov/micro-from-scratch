# Омоним экземпляра типа

11 января 2007 

![Martin Fowler](../microservice-guide/images/microservices/mf.jpg)

[Мартин Фаулер](https://martinfowler.com/)

[ПРЕДМЕТНО-ОРИЕНТИРОВАННОЕ ПРОЕКТИРОВАНИЕ](https://martinfowler.com/tags/domain%20driven%20design.html)

> «Война и мир» — замечательная книга.

> "Дайте-ка посмотреть... жаль, что у этой книги такая рваная обложка"

Два предложения, в каждом из которых используется слово «книга». Мы видим 
подобное каждый день, не замечая, что слово «книга» означает в каждом из этих 
предложений что-то совершенно разное.

В первом предложении «книга» относится к литературному произведению, которое 
существует с нами уже более ста лет. Во втором предложении «книга» теперь 
относится к физическому объекту, который, вероятно, существует намного меньше.
Я могу легко уничтожить последнюю в огне, но первую не коснется пламя, и, несомненно, 
оно проживет дольше, чем я. Я могу поместить первую на свой жесткий диск со 
многими произведениями, которые в совокупности весят меньше, чем вторая.

Эта конкретная двусмысленность поразительно распространена в естественном языке.
Подумайте о таких словах, как «автомобиль», «дуб» и «программист». Попытка 
исправить это может легко привести вас в более темные уголки семантики в 
философии. На данный момент я просто объясню, что я думаю об этом.

Слово «книга» — это термин, который имеет несколько значений. Два приведенных выше 
предложения иллюстрируют два понятия, к которым относится «книга»: литературное 
произведение и физическая копия. Поскольку большинство моих читателей — программисты, 
я воспользуюсь аналогией с программированием и скажу, что есть два разных класса, 
каждый из которых называется «книгой». Мы можем устранить неоднозначность, назвав 
их классами `LiteraryWork` и `PhysicalCopy`. Когда в первом предложении я 
говорю, что «Война и мир» — это книга, я имею в виду, что «Война и мир» — это 
экземпляр класса `LiteraryWork`. Второе предложение относится к свойствам экземпляра 
`PhysicalCopy`.

Эти два понятия не являются независимыми. В отличие от таких омонимов, как 
right и right (противоположности левому и неправильному), эти два понятия имеют 
тесную связь [[1]](https://martinfowler.com/bliki/TypeInstanceHomonym.html#footnote-polysemy).
Книга [PhysicalCopy] является визуализацию книги [LiteraryWork]. Так что я могу 
сказать, что у моей «Войны и мира» рваная обложка. Точно так же мой Subaru Legacy 
[экземпляр физической машины] связан с Subaru Legacy [экземпляр модели 
автомобиля]. Действительно, можно сказать, что тип моей машины — Subaru Legacy 
[модель автомобиля]. Этот тип отношений очень распространен и знаком людям, 
которые занимаются любым видом моделирования объектов или данных. Вы часто 
видите похожие структуры, включающие такие вещи, как Product и Product Type.
Я бы не стал использовать термины «Книга» и «Тип книги», но по сути это одно 
и то же.

Потратьте время на моделирование или программирование практически в любой 
области, и вы достигнете момента, когда вам нужно будет взять какой-то общий 
термин в этой области и понять, что он обозначает две отдельные концепции, 
которые означают отдельные классы (или таблицы) с разными именами в вашем коде.
Когда вы получаете омонимы в вашем языке предметной области, это часто происходит 
потому, что термины используются по-разному в разных контекстах — то, что Эрик 
Эванс называет ограниченными контекстами. Как любил подмечать Джим Оделл: фраза 
«У Мэри был ягненок» означает для ветеринара совсем другое, чем для ресторатора. 
Проблема с омонимом экземпляра типа заключается в том, что он встречается даже 
в очень тесно ограниченных контекстах.

Моя цель здесь не в том, чтобы говорить дальше о моделировании таких ситуаций, 
это отдельная тема, а в том, чтобы поразмышлять о двусмысленности, которую 
вызывает этот распространенный тип омонимов. Что действительно интересно в этой 
двусмысленности, так это то, как мало проблем она вызывает. У людей, похоже, 
нет проблем с переключением между несколькими концепциями, и они лишь изредка 
спотыкаются в процессе. Что еще хуже, если вы активно пытаетесь использовать 
разные термины в повседневном разговоре, его почти невозможно поддерживать. Я, 
конечно, пытался, как в разговоре, так и в письме, и быстро понял, что это 
безнадежное дело. У меня не только не хватало терпения, но это делало меня
похожим на человека с каким-то неясным психическим заболеванием. (Экземпляр типа -
не единственный, обладающий этим свойством, как предполагает фраза «пройдите через 
дверь, которую мы покрасили (слово painted можно перевести и как «нарисовали») на 
прошлой неделе».)

В моей собственной специализации объектно-ориентированного проектирования существует
особенно интересный случай. Мы часто говорим о таких вещах, как «добавить метод 
к объекту». Но, конечно же, мы не добавляем методы к объектам, мы добавляем их 
к классам. В какой-то момент своей карьеры вы были педантом, указавшим на это 
на собрании. С тех пор вы также без особых усилий умалчивали об этом моменте в 
бесчисленных разговорах.

Так что я пришел к выводу, что мы обязательно должны знать об этом омониме.
Нам нужно представлять понятия отдельно и с разными именами в нашем программном 
обеспечении. Но нам не следует ожидать различия между ними в нашем разговоре, 
если только мы не находимся в контексте, где существует реальная опасность 
путаницы, потому что большую часть времени наш мозг разрешает двусмысленность 
автоматически.

Так что же это означает в контексте [единого языка](https://martinfowler.com/bliki/UbiquitousLanguage.html)?
Во-первых, мы должны провести моделирование и понять, что у нас разные концепции 
(учитывая омоним). Затем мы придумываем названия для различных понятий, которые 
будем использовать в нашем вездесущем языке и, таким образом, в программном 
представлении. Придумывая эти имена, я предпочитаю избегать непосредственных 
омонимов: поэтому я бы не использовал слово «книга» в библиотечном контексте, 
предпочитая что-то вроде «Литературное произведение» и «Физическая копия».
Эти термины, устраняющие неоднозначность, должны быть понятны экспертам в 
предметной области, как и все остальное в вездесущем языке. Поэтому эксперты в 
предметной области должны знать об омонимах и помогать придумывать новые термины. 
Затем мы используем новые термины всякий раз, когда нам нужна точность. Однако нам 
следует опасаться попыток полностью искоренить омоним. Он фактически становится 
синонимом для каждого из новых терминов. Так что, если специалист по предметной 
области говорит, что «у книги есть авторы», мы можем сказать: «Вы имеете в виду 
литературное произведение, верно?» Помните, что всем будет казаться неестественным 
не использовать термин-омоним, поэтому уточняйте что необходимо. К счастью, 
осведомленность — это 90% победы.

Еще одним следствием этого омонима является то, что ваш мозг всегда должна искать 
их, особенно в первые дни работы в новой предметной области. Обычно это происходит 
в терминах, которые являются абсолютно центральными для этой области — как в 
случае с книгами и библиотеками. Мне нравилось использовать неформальные 
диаграммы классов для моделирования вездесущего языка, и я обнаружил, что это 
хорошо помогает выявлять подобные омонимы.

## Примечания

1: Джим Уайт написал мне по электронной почте, чтобы сообщить мне, что в 
лингвистике термин «полисемия» иногда используется для обозначения слова, 
которое имеет разные, но родственные значения.

Опубликовано 19 марта 2013 г.