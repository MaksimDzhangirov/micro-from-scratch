# Валюта как изменяемая величина

26 августа 2003

![Martin Fowler](../microservice-guide/images/microservices/mf.jpg)

[Мартин Фаулер](https://martinfowler.com/)

[ПРЕДМЕТНО-ОРИЕНТИРОВАННОЕ ПРОЕКТИРОВАНИЕ](https://martinfowler.com/tags/domain%20driven%20design.html)

Существует много распространенных примеров [ValueObject](https://martinfowler.com/bliki/ValueObject.html), 
мой любимый — [Money](https://martinfowler.com/eaaCatalog/money.html), и 
один из них тесно связанный с Money — это валюта.

Для многих систем валюта хорошо работает в качестве значения, ключевой частью, 
которой является международно признанный код валюты (например, USD 
для долларов США).

Однако однажды я был связан с системой, где её использование было немного 
интереснее. Если мне не изменяет память, одним из требований к валюте было 
«цена 1 пункта». В пользовательском интерфейсе у них были кнопки, чтобы 
менять стоимость валюты вверх и вниз. У каждой валюты была своя цена 1 пункта, 
и эта цена могла меняться. Она менялась не часто, но менялась. Это нарушает 
очень полезное правило объектов-значений — они неизменяемы.

Решение, которое мы использовали, состояло в том, что у нас было два класса 
валюты. Один был объектом-значением, он содержал код валюты и, возможно, другие 
неизменяемые величины. Второй был ссылочным объектом (думаю, мы назвали их 
что-то вроде `CurrencyValue` и `CurrencyReference`). Объект-значение передавался 
большую часть времени, но некоторые методы в объекте-значении, делегировались 
ссылочному объекту, который в основном содержал статические данные. Ссылочные
объекты хранились в таблице поиска, индексированной по коду валюты (это не 
единственный способ сделать это).

Такое двойственное поведение с семантической точки зрения необычно — я видел 
его только один раз. Конечно, для большинства систем подойдёт простой объект-значение 
для валюты. 